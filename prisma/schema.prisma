generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

type Address {
  zipcode        String
  state          String
  city           String
  district       String
  address        String
  number         Int
  complement     String?
}

model User {
  id             String                  @id @default(auto()) @map("_id") @db.ObjectId
  name           String        
  image          String?         
  email          String                  @unique
  phone          String                  @unique
  documentNumber String                  @unique
  zipcode        String        
  password       String        
  products       Product[]         
  orders         Order[]         
  createdAt      DateTime                @default(now())
}    

model Product {
  id            String                   @id @default(auto()) @map("_id") @db.ObjectId
  name          String                 
  userId        String                   @db.ObjectId
  user          User                     @relation(fields: [userId], references: [id])
  variants      Variant[]                
  createdAt     DateTime                 @default(now())
}

model Order {    
  id             String                  @id @default(auto()) @map("_id") @db.ObjectId
  phone          String 
  offerIds       String[]                @db.ObjectId
  offers         Offer[]                 @relation(fields: [offerIds], references: [id])
  userId         String                  @db.ObjectId
  user           User                    @relation(fields: [userId], references: [id])
  address        Address     
  date           DateTime      
  createdAt      DateTime                @default(now())
}


model Offer {
  id            String                   @id @default(auto()) @map("_id") @db.ObjectId
  name          String
  variants      OfferVariant[]  
  orderIds      String[]                 @db.ObjectId
  orders        Order[]                  @relation(fields: [orderIds], references: [id])
}

type OfferVariant {
  variantId     String                   @db.ObjectId
  amount        Int
}

model Variant {
  id                   String            @id @default(auto()) @map("_id") @db.ObjectId
  productId            String            @db.ObjectId
  product              Product           @relation(fields: [productId], references: [id]) 
  amountAvailable      Int
  price                Float
  color                String?
  size                 String?
  type                 String?
}





